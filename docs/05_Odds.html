<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Odds – Design of Experimental Studies and Statistics Applied to Nutrigenomics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06_Descriptiva.html" rel="next">
<link href="./04_ProbOddsChiCuadrado.html" rel="prev">
<link href="./Figures/atlas.jpeg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05_Odds.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Odds</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Design of Experimental Studies and Statistics Applied to Nutrigenomics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Cruzalirio/Nutrigenomics" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo lector">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_TypesStudies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Overview</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_FirstR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Variable Classification and R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_ProbOddsChiCuadrado.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Odds.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Odds</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Descriptiva.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./referencias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#conditional-probability" id="toc-conditional-probability" class="nav-link active" data-scroll-target="#conditional-probability"><span class="header-section-number">5.0.1</span> Conditional Probability</a></li>
  <li><a href="#independent-events" id="toc-independent-events" class="nav-link" data-scroll-target="#independent-events"><span class="header-section-number">5.0.2</span> Independent Events</a></li>
  <li><a href="#conditional-odds-and-relative-odds-ratios" id="toc-conditional-odds-and-relative-odds-ratios" class="nav-link" data-scroll-target="#conditional-odds-and-relative-odds-ratios"><span class="header-section-number">5.0.3</span> Conditional Odds and Relative Odds Ratios</a></li>
  <li><a href="#example-in-r" id="toc-example-in-r" class="nav-link" data-scroll-target="#example-in-r"><span class="header-section-number">5.1</span> Example in R</a></li>
  <li><a href="#chi-squared-test" id="toc-chi-squared-test" class="nav-link" data-scroll-target="#chi-squared-test"><span class="header-section-number">6</span> Chi-Squared Test</a>
  <ul class="collapse">
  <li><a href="#example-in-r-1" id="toc-example-in-r-1" class="nav-link" data-scroll-target="#example-in-r-1"><span class="header-section-number">6.1</span> Example in R</a></li>
  </ul></li>
  <li><a href="#relative-risk" id="toc-relative-risk" class="nav-link" data-scroll-target="#relative-risk"><span class="header-section-number">7</span> Relative Risk</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">8</span> Exercises</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Cruzalirio/Nutrigenomics/edit/main/05_Odds.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/Cruzalirio/Nutrigenomics/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Odds</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>In some contexts, probabilities are presented in the form of <em>odds</em>. The most common translation in Spanish is <a href="https://es.wikipedia.org/wiki/Apuesta_deportiva#Momios_o_Cuotas_Deportivas"><strong>momios</strong></a>, but others are used: posibilidades, oportunidades, oportunidades… Here we will use <em>odds</em>.</p>
<p>The <strong>odds</strong> of an event <span class="math inline">\(A\)</span> are <span class="math display">\[
\text{Odds}(A)=\frac{P(A)}{P(A^c)}=\frac{P(A)}{1-P(A)}
\]</span> and therefore tell us how many times more likely <span class="math inline">\(A\)</span> is than “not <span class="math inline">\(A\)</span>”.</p>
<p>If <span class="math inline">\(\text{Odds}(A)=q\)</span>, it means that <strong>for every time “not <span class="math inline">\(A\)</span>” occurs, <span class="math inline">\(A\)</span> occurs <span class="math inline">\(q\)</span> times</strong>. For example, if the odds of failing a subject are 2/3, it means that:</p>
<ul>
<li><p>For every student who passes, 2/3 fail.</p></li>
<li><p>For every 3 students who pass, 2 fail.</p></li>
<li><p>Of every 5 students, 3 pass and 2 fail.</p></li>
<li><p>2 out of every 5 students fail.</p></li>
<li><p>The <strong>probability</strong> of failing is 40%.</p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sometimes, odds ratios of <span class="math inline">\(a/b\)</span> are expressed as <span class="math inline">\(a\!:\!b\)</span>, and are read as “<span class="math inline">\(a\)</span> a <span class="math inline">\(b\)</span>”. For example, the <em>odds</em> of failing above are 2:3, that is, 2 to 3.</p>
</div>
</div>
<strong>Example:</strong>
<div style="border-left: 4px solid #f0ad4e; background-color: #fcf8e3; padding: 10px; margin: 10px 0;">
<p>Some examples of <em>odds</em> from probabilities:</p>
<ul>
<li>If <span class="math inline">\(P(A)=0.2\)</span>, <span class="math inline">\(\text{Odds}(A)=0.2/0.8=0.25\)</span>.</li>
<li>If <span class="math inline">\(P(A)=0\)</span>, <span class="math inline">\(\text{Odds}(A)=0\)</span>.</li>
<li>If <span class="math inline">\(P(A)=0.5\)</span>, <span class="math inline">\(\text{Odds}(A)=1\)</span>.</li>
<li>If <span class="math inline">\(P(A)=1\)</span>, <span class="math inline">\(\text{Odds}(A)=\infty\)</span>.</li>
</ul>
</div>
<p>Since they are a quotient of two probabilities, the <em>odds</em> of an event are always greater than or equal to 0 and can take any value between 0 and <span class="math inline">\(\infty\)</span>, inclusive.</p>
<p><strong>Exercise</strong> If we roll a balanced 10-sided die numbered from 0 to 9:</p>
<ol type="1">
<li><p>What are the <em>odds</em> of rolling a 3?</p></li>
<li><p>What are the <em>odds</em> of rolling a multiple of 3?</p></li>
</ol>
<p>If we know the <em>odds</em> of <span class="math inline">\(A\)</span>, we can calculate the probability <span class="math inline">\(P(A)\)</span>: <span class="math display">\[
\begin{array}{rl}
\text{Odds}(A)=\dfrac{P(A)}{1-P(A)}\!\!\!\! &amp; \Longrightarrow \text{Odds}(A)-\text{Odds}(A)P(A)=P(A)\\
&amp; \Longrightarrow P(A)=\dfrac{\text{Odds}(A)}{1+\text{Odds}(A)}
\end{array}
\]</span></p>
<p>Therefore, two events have the same probability if, and only if, they have the same <em>odds</em>.</p>
<p>Note that the function <span class="math display">\[
x\mapsto\frac{x}{1+x}
\]</span> is increasing in <span class="math inline">\(x\)</span>:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05_Odds_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Graph of the curve y=x/(1+x).</figcaption>
</figure>
</div>
</div>
</div>
<p>Since this is the function that transforms <span class="math inline">\(\text{Odds}(A)\)</span> into <span class="math inline">\(P(A)\)</span>, we deduce that <span class="math display">\[
\text{Odds}(A)&gt;\text{Odds}(B)\Longleftrightarrow P(A)&gt;P(B)
\]</span></p>
<blockquote class="blockquote">
<p><span class="math inline">\(A\)</span> is more likely than <span class="math inline">\(B\)</span> if, and only if, the <em>odds</em> of <span class="math inline">\(A\)</span> are greater than those of <span class="math inline">\(B\)</span>.</p>
</blockquote>
<p>As we will see, the correct way to present the results in case-control studies is in the form of odds ratios. The odds ratio of two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is the quotient of their odds: <span class="math display">\[
\text{OR}(A,B)=\frac{\text{Odds}(A)}{\text{Odds}(B)}
\]</span> That is, <span class="math inline">\(\text{OR}(A,B)\)</span> tells us how many times greater (or less) the odds of <span class="math inline">\(A\)</span> are than those of <span class="math inline">\(B\)</span>. Its value is difficult to interpret in terms of probabilities except for its relationship to 1:</p>
<ul>
<li><p><span class="math inline">\(\text{OR}(A,B)=1\Longleftrightarrow \text{Odds}(A)=\text{Odds}(B) \Longleftrightarrow P(A)=P(B)\)</span></p></li>
<li><p><span class="math inline">\(\text{OR}(A,B)&gt;1\Longleftrightarrow \text{Odds}(A)&gt;\text{Odds}(B) \Longleftrightarrow P(A)&gt;P(B)\)</span></p></li>
<li><p><span class="math inline">\(\text{OR}(A,B)&lt;1\Longleftrightarrow \text{Odds}(A)&lt;\text{Odds}(B) \Longleftrightarrow P(A)&lt;P(B)\)</span></p></li>
</ul>
<p>But for example <span class="math display">\[
\text{OR}(A,B)=2 \Longleftrightarrow \text{Odds}(A)= 2\cdot \text{Odds}(B) \hspace{1.2ex}
\not\hspace{-1.2ex}\Longleftrightarrow P(A)=
2\cdot P(B)
\]</span></p>
<strong>Example:</strong>
<div style="border-left: 4px solid #f0ad4e; background-color: #fcf8e3; padding: 10px; margin: 10px 0;">
<p>A <a href="https://www.gastrojournal.org/article/S0016-5085(20)30490-X/fulltext">case-control study</a> (Y. Nobel <em>et al</em>, <em>Gastroenterology</em> 159 (2020), pp.&nbsp;373-375) states that</p>
<blockquote class="blockquote">
<p>“the presence of gastrointestinal symptoms was associated with a 70% increased risk of testing positive [on the COVID-19]: odds ratio, 1.7.”</p>
</blockquote>
<p>What does this mean? An <em>odds ratio</em> of 1.7 means that the <em>odds</em> of testing positive for COVID-19 if you have gastrointestinal symptoms are 1.7 times the odds of testing positive if you don’t have gastrointestinal symptoms, i.e., 70% higher. But note that we’re talking about <em>odds</em>, not <strong>risk</strong> understood in the sense of <strong>probability</strong>. It doesn’t necessarily mean that the probability of testing positive for COVID-19 if you have gastrointestinal symptoms is 70% higher than if you don’t have gastrointestinal symptoms.</p>
<p>In fact, in this particular study, the following frequency table was obtained (GI symptoms abbreviated as “gastrointestinal symptoms”) <span class="math display">\[
\begin{array}{r|c|c|c}
&amp; \text{COVID-19 } + &amp; \text{COVID-19 } - &amp; \text{Total}\\ \hline
\text{GI Yes} &amp; 97&amp; 63 &amp; 160\\\hline
\text{GI No} &amp; 181 &amp; 175 &amp; 356\\\hline
\text{Total} &amp; 278 &amp; 238 &amp;316
\end{array}
\]</span></p>
<p>Therefore, the proportion of COVID-19 positive cases among those with gastrointestinal symptoms was 97/160 = 0.606, and the proportion of COVID-19 positive cases among those without gastrointestinal symptoms was 181/356 = 0.508. Since 0.606/0.508 = 1.19, the former is 19% higher than the latter, not 70% higher.</p>
<p>Let’s look at the odds. The odds of being COVID-19 positive among those with gastrointestinal symptoms are <span class="math display">\[
\frac{97/160}{63/160}=1.54
\]</span> The odds of being COVID-19 positive among those without gastrointestinal symptoms are <span class="math display">\[
\frac{181/356}{175/356}=1.03
\]</span> The odds ratio is then 1.54/1.03=1.495.</p>
<p>But didn’t we say that their odds ratio was 1.7?</p>
<p>Well, yes, what gives them 1.7 is the adjusted odds ratio, ORa, an odds ratio obtained by discounting the influence of confounders on the outcome.</p>
</div>
<section id="conditional-probability" class="level3" data-number="5.0.1">
<h3 data-number="5.0.1" class="anchored" data-anchor-id="conditional-probability"><span class="header-section-number">5.0.1</span> Conditional Probability</h3>
<p>Given two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, with <span class="math inline">\(P(A)&gt;0\)</span>, the <strong>probability of <span class="math inline">\(B\)</span> conditioned on <span class="math inline">\(A\)</span></strong> is <span class="math display">\[
P(B|A)=\frac{P(A\cap B)}{P(A)}
\]</span></p>
<p>This value represents the fraction of the subjects in <span class="math inline">\(A\)</span> that belong to <span class="math inline">\(B\)</span>; that is, it is the probability that if <span class="math inline">\(A\)</span> occurs, then <span class="math inline">\(B\)</span> also occurs.</p>
<strong>Example:</strong>
<div style="border-left: 4px solid #f0ad4e; background-color: #fcf8e3; padding: 10px; margin: 10px 0;">
<p>Suppose that in a class of 20 men and 30 women, 15 men and 18 women wear glasses. The corresponding frequency table is</p>
<p><span class="math display">\[
\begin{array}{r|c|c|c}
&amp; \text{Glasses} &amp; \text{No glasses} &amp; \text{Total}\\ \hline
\text{Women} &amp; 18 &amp; 12 &amp; 30\\ \hline
\text{Men} &amp; 15 &amp; 5 &amp; 20 \\ \hline
\text{Total} &amp; 33 &amp; 17 &amp; 50 \\
\end{array}
\]</span></p>
<ol type="1">
<li>What is the probability that a student is female?</li>
</ol>
<p>Since there are 30 women out of a total of 50 students, this probability is 30/50 = 0.6</p>
<ol start="2" type="1">
<li>What is the probability that a student wears glasses?</li>
</ol>
<p>Since there are 33 students with glasses out of a total of 50 students, this probability is 33/50 = 0.66.</p>
<ol start="3" type="1">
<li>What is the probability that a student is female and wears glasses?</li>
</ol>
<p>Since the probability of being female is 0.6 and the probability of wearing glasses is 0.66, the probability of being female and wearing glasses is the product: 0.6 0.66 = 0.396.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Precaución
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>No!</strong> In general, the probability of the intersection is NOT the product of the probabilities.</p>
</div>
</div>
<p>Let’s calculate it carefully. Since there are 18 women wearing glasses out of a total of 50 students, this probability is 18/50 = 0.36.</p>
<ol start="4" type="1">
<li>What is the probability that a woman wears glasses?</li>
</ol>
<p>Since there are 18 women wearing glasses out of a total of 30 women, this probability is 18/30 = 0.6. Note that this value is equal to <span class="math display">\[
P(\text{glasses}|\text{woman})=\frac{P(\text{woman and glasses})}{P(\text{woman})}=\frac{18/50}{30/50}=\frac{18}{30}
\]</span></p>
<ol start="5" type="1">
<li>We choose a student at random. What is the probability that if she is a woman, she wears glasses?</li>
</ol>
<p>This is the same question as the previous one, so the answer is the same: 18/30=0.6.</p>
<ol start="6" type="1">
<li>What is the probability that a student wearing glasses is a woman?</li>
</ol>
<p>Since there are 18 women wearing glasses out of a total of 33 students wearing glasses, this probability is 18/33=0.545. Note, again, that this value is equal to <span class="math display">\[
P(\text{woman}|\text{glasses})=\frac{P(\text{woman and glasses})}{P(\text{glasses})}=\frac{18/50}{33/50}=\frac{18}{33}
\]</span></p>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Don’t get confused:</p>
<ul>
<li><span class="math inline">\(P(B)\)</span>: The probability that an individual in the global population <span class="math inline">\(\Omega\)</span> belongs to <span class="math inline">\(B\)</span>.</li>
</ul>
<p>For example, if <span class="math inline">\(B\)</span> is “wearing glasses,” <span class="math inline">\(P(B)\)</span> is the probability that a person wears glasses. The population in which we calculate probabilities is <strong>all people</strong>.</p>
<ul>
<li><span class="math inline">\(P(B|A)\)</span>: Probability that an individual in <span class="math inline">\(A\)</span> belongs to <span class="math inline">\(B\)</span>.</li>
</ul>
<p>For example, if <span class="math inline">\(A\)</span> also means “being a woman,” <span class="math inline">\(P(B|A)\)</span> is the probability that a <strong>woman</strong> wears glasses. The population in which we calculate probabilities is that of <strong>women</strong>.</p>
<ul>
<li><span class="math inline">\(P(A|B)\)</span>: Probability that an individual in <span class="math inline">\(B\)</span> belongs to <span class="math inline">\(A\)</span>.</li>
</ul>
<p>For example, using the notations above, <span class="math inline">\(P(A|B)\)</span> is the probability that a person who wears glasses is a woman. The population in which we calculate probabilities is that of <strong>people who wear glasses</strong>.</p>
<ul>
<li><span class="math inline">\(P(B\cap A)\)</span>: Probability that an individual in the overall population belongs simultaneously to both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</li>
</ul>
<p>For example, using the notations above, <span class="math inline">\(P(A\cap B)\)</span> is the probability that a person <strong>is a woman and wears glasses</strong>. The population in which we calculate probabilities is again <strong>all people</strong>.</p>
</div>
</div>
<p><strong>Exercise:</strong></p>
<p>At a university, students are distributed as follows by type of study and gender: <span class="math display">\[
\begin{array}{r|c|c|c|c|c}
\text{Study} &amp; \text{Science} &amp; \text{Law} &amp; \text{Education} &amp; \text{Others} &amp; \text{Total}\\ \hline
\text{Men} &amp; 1200 &amp; 1300 &amp; 300 &amp; 2000 &amp; 4800\\ \hline
\text{Women} &amp; 1400 &amp; 600 &amp; 1600 &amp; 1600 &amp; 5200\\ \hline
\text{Total} &amp; 2600 &amp; 1900 &amp; 1900 &amp; 3600 &amp; 10000\\
\end{array}
\]</span></p>
<p>If I choose a student at random, what is the probability that:</p>
<ol type="a">
<li>They are male or female?</li>
<li>They are female?</li>
<li>They study Science?</li>
<li>They do not study Science?</li>
<li>They are female or study Law?</li>
<li>They are female and study Law?</li>
<li>They are female but do not study Law?</li>
<li>If they study Education, are they female?</li>
<li>If they are female, do they study Education?</li>
<li>If they are female, do they not study Education?</li>
<li>If they are not female, do they study Education?</li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>The probability conditional on <span class="math inline">\(A\)</span>, <span class="math inline">\(P(\ldots|A)\)</span>, is a “true” probability; we have simply changed the population from <span class="math inline">\(\Omega\)</span> to <span class="math inline">\(A\)</span>. That is, instead of working with proportions of the total population <span class="math inline">\(\Omega\)</span>, we work with proportions of the subpopulation defined by the subjects in <span class="math inline">\(A\)</span>. Therefore, <span class="math inline">\(P(\ldots |A)\)</span> satisfies all the properties of probabilities. For example, it is true that:</p>
<ul>
<li><span class="math inline">\(P(B^c|A)=1-P(B|A)\)</span></li>
<li><span class="math inline">\(P(C-B|A)=P(C|A)-P(B\cap C|A)\)</span></li>
<li><span class="math inline">\(P(B\cup C|A)=P(B|A)+P(C|A)-P(B\cap C|A)\)</span></li>
</ul>
</div>
</div>
<strong>Example:</strong>
<div style="border-left: 4px solid #f0ad4e; background-color: #fcf8e3; padding: 10px; margin: 10px 0;">
<p>Suppose 15% of adults are hypertensive, 25% of adults believe they are hypertensive, and 9% of adults are hypertensive and believe they are.</p>
<ul>
<li><p>If an adult believes they are hypertensive, what is the probability that they are?</p></li>
<li><p>If an adult is hypertensive, what is the probability that they believe they are?</p></li>
<li><p>If an adult doesn’t believe they are hypertensive, what is the probability that they are?</p></li>
</ul>
<p>Let’s name the events involved in these questions:</p>
<ul>
<li><p><span class="math inline">\(A\)</span>: Being hypertensive; <span class="math inline">\(P(A)=0.15\)</span></p></li>
<li><p><span class="math inline">\(B\)</span>: Believing they are hypertensive; <span class="math inline">\(P(B)=0.25\)</span></p></li>
<li><p><span class="math inline">\(A\cap B\)</span>: Being hypertensive and believing it; <span class="math inline">\(P(A \cap B)=0.09\)</span></p></li>
</ul>
<p>The first question asks us for the probability of <span class="math inline">\(A\)</span> conditional on <span class="math inline">\(B\)</span>: <span class="math display">\[
P(A|B)=\frac{P(A\cap B)}{P(B)}=\dfrac{0.09}{0.25}=0.36
\]</span> If an adult believes they are hypertensive, they have a 36% chance of being so.</p>
<p>In the second question, we are asked the probability of <span class="math inline">\(B\)</span> conditional on <span class="math inline">\(A\)</span>: <span class="math display">\[
P(B|A) =\frac{P(A\cap B)}{P(A)}=\frac{0.09}{0.15}=0.6
\]</span> If an adult is hypertensive, they have a 60% probability of believing they are.</p>
<p>And in the third question, we are asked the probability of <span class="math inline">\(A\)</span> conditional on <span class="math inline">\(B^c\)</span>: <span class="math display">\[
P(A|B^c) =\frac{P(A\cap B^c)}{P(B^c)}=\frac{P(A)-P(A\cap B)}{1-P(B)}=\frac{0.06}{0.75}=0.08
\]</span> If an adult does not believe they are hypertensive, they have an 8% probability of being hypertensive.</p>
</div>
<strong>Example:</strong>
<div style="border-left: 4px solid #f0ad4e; background-color: #fcf8e3; padding: 10px; margin: 10px 0;">
<p>An HIV test is positive in 99% of cases where the virus is present. In a population with 0.5% HIV infection:</p>
<ul>
<li><p>What is the probability that if we test an infected person, they will be positive?</p></li>
<li><p>What is the probability that we test an infected person and they will be positive?</p></li>
</ul>
<p>The answer to the first question is given in the statement: “the test is positive in 99% of cases where the virus is present,” so “the probability that if we test an infected person, they will be positive” is 0.99.</p>
<p>But the second question doesn’t ask the same thing as the first, but rather the probability of two things happening: that we test an infected person <strong>AND</strong> that they test positive. This is the probability of an intersection.</p>
<p>Let’s name it:</p>
<ul>
<li><p><span class="math inline">\(A\)</span>: Being infected; <span class="math inline">\(P(A)=0.005\)</span></p></li>
<li><p><span class="math inline">\(B\)</span>: Testing positive. Of this event, we only know the conditional probability <span class="math inline">\(P(B|A)=0.99\)</span></p></li>
<li><p><span class="math inline">\(A\cap B\)</span>: Being infected and testing positive. This is the event for which we are asked the probability. <span class="math display">\[
P(B|A)=\frac{P(A \cap B)}{P(A)}\Longrightarrow P(A \cap B)=P(B|A)\cdot P(A)=0.99\cdot 0.005=0.00495
\]</span></p></li>
</ul>
<p>The probability that a random individual will test positive and be infected is 0.495%.</p>
</div>
<strong>Example:</strong>
<div style="border-left: 4px solid #f0ad4e; background-color: #fcf8e3; padding: 10px; margin: 10px 0;">
<p>A cardiologist friend once told us that half of the patients who came to his office with supposed heart problems were actually stressed, and two-thirds were depressed. We’re also going to assume that only 15% of these patients did not suffer from either of these two conditions.</p>
<ul>
<li>What is the probability that such a patient has stress if they have depression?</li>
<li>What is the probability that such a patient <strong>does not</strong> have stress if they <strong>do not</strong> have depression?</li>
</ul>
<p>This time, we’re going to use the natural frequencies method first. Let’s assume we have a reference population of 300 people who see a cardiologist.</p>
<ul>
<li>Half, 150, have stress, and the other 150 do not.</li>
<li>Two-thirds, 200, have depression, and 100 do not.</li>
<li>There are 15% of the population, or 45 subjects, who do not have either of these two conditions.</li>
</ul>
<p>In summary, for now we have that <span class="math display">\[
\begin{array}{r|c|c|c}
&amp; \text{Depression} &amp; \text{Non-depression} &amp; \text{Total}\\ \hline
\text{Stress} &amp; &amp; &amp; 150 \\ \hline
\text{Non-stress} &amp; &amp; 45 &amp; 150 \\ \hline
\text{Total} &amp; 200 &amp; 100 &amp; 300\\
\end{array}
\]</span></p>
<ul>
<li>AhNow:</li>
<li>Of the 150 who don’t have stress, about 45 don’t have depression either, there are 105 who do have depression.</li>
<li>Of the 100 who don’t have depression, about 45 don’t have stress either, there are 55 who do have stress.</li>
<li>Of the 150 who have stress, about 55 don’t have depression, there are 95 who do have stress.</li>
</ul>
<p>We now have the complete frequency table: <span class="math display">\[
\begin{array}{r|c|c|c}
&amp; \text{Depression} &amp; \text{Non-depression} &amp; \text{Total}\\ \hline
\text{Stress} &amp; 95 &amp; 55 &amp; 150 \\ \hline
\text{Non-stress} &amp; 105 &amp; 45 &amp; 150 \\ \hline
\text{Total} &amp; 200 &amp; 100 &amp; 300\\
\end{array}
\]</span> And now:</p>
<ul>
<li><p>Since there are 200 patients with depression, of which 95 also have stress, the proportion of patients with depression who have stress is 95/200 = 0.475. 47.5% of patients who have depression also have stress.</p></li>
<li><p>Since there are 100 patients without depression, of whom 45 do not have stress, the proportion of patients without depression who also do not have stress is 45/100 = 0.45. 45% of patients who do not have depression also do not have stress.</p></li>
</ul>
<p>How would we have solved this using the properties of probabilities? Let’s name them:</p>
<ul>
<li><p><span class="math inline">\(E\)</span>: Having stress; <span class="math inline">\(P(E)=0.5\)</span></p></li>
<li><p><span class="math inline">\(D\)</span>: Having depression; <span class="math inline">\(P(D)=2/3\)</span></p></li>
<li><p><span class="math inline">\(E^c \cap D^c\)</span>: Having neither stress nor depression; <span class="math inline">\(P(E^c\cap D^c)=0.15\)</span></p></li>
</ul>
<p>With these notations, in the first question they ask us <span class="math display">\[
P(E|D)=\dfrac{P(E\cap D)}{P(D)}
\]</span> To calculate it, we need to know <span class="math inline">\(P(E\cap D)\)</span>, which is worth: <span class="math display">\[
P(E\cap D)=P(E)P(D)=0.5\cdot \frac{2}{3}=0.3333
\]</span></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Precaución
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>No!</strong> That the probability of the intersection is NOT in general equal to the product of the probabilities!</p>
</div>
</div>
<p>You’ll have to work on something else:</p>
<ol type="1">
<li><p><span class="math inline">\(P((E\cup D)^c)=P(E^c\cap D^c)=0.15\)</span>, therefore <span class="math inline">\(P(E\cup D)=1-P((E\cup D)^c)=0.85\)</span></p></li>
<li><p><span class="math inline">\(P(E\cap D)=P(E)+P(D)-P(E\cup D)=0.5+2/3-0.85=0.31667\)</span></p></li>
</ol>
<p>Now, finally, <span class="math inline">\(P(E|D)=P(E\cap D)/P(D)=0.31667/0.66667=0.475\)</span></p>
<p>In the second question they ask us <span class="math display">\[
P(E^c|D^c)=\dfrac{P(E^c\cap D^c)}{P(D^c)}
\]</span> and we can now calculate this probability, Because we know that <span class="math inline">\(P(E^c\cap D^c)=0.15\)</span> and <span class="math inline">\(P(D^c)=1-P(D)=1-2/3=1/3\)</span>, so <span class="math inline">\(P(E^c|D^c)=P(E^c\cap D^c)/P(D^c)=0.15/(1/3)=0.45\)</span>.</p>
</div>
</section>
<section id="independent-events" class="level3" data-number="5.0.2">
<h3 data-number="5.0.2" class="anchored" data-anchor-id="independent-events"><span class="header-section-number">5.0.2</span> Independent Events</h3>
<p>Two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> (both with probability not 0) are <strong>independent</strong> when <span class="math inline">\(P(B|A)=P(B)\)</span>. That is:</p>
<ul>
<li>When belonging to <span class="math inline">\(A\)</span> does not change the probability of belonging to <span class="math inline">\(B\)</span>.</li>
<li>When the occurrence of <span class="math inline">\(A\)</span> does not change the probability of <span class="math inline">\(B\)</span> occurring.</li>
<li>When the proportion of subjects from <span class="math inline">\(B\)</span> within <span class="math inline">\(A\)</span> is the same as that within the total population.</li>
</ul>
<p>In this definition, the roles of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are interchangeable, as the following result shows, which also provides a very important alternative characterization.</p>
<blockquote class="blockquote">
<p>Given two events <span class="math inline">\(A,B\)</span>, both with probability neither 0 nor 1, the following five conditions are equivalent:</p>
<ol type="a">
<li><span class="math inline">\(P(A \cap B)=P(A)\cdot P(B)\)</span></li>
<li><span class="math inline">\(P(B|A)=P(B)\)</span></li>
<li><span class="math inline">\(P(A|B)=P(A)\)</span></li>
<li><span class="math inline">\(P(B|A)=P(B|A^c)\)</span></li>
<li><span class="math inline">\(P(A|B)=P(A|B^c)\)</span></li>
</ol>
</blockquote>
</section>
<section id="conditional-odds-and-relative-odds-ratios" class="level3" data-number="5.0.3">
<h3 data-number="5.0.3" class="anchored" data-anchor-id="conditional-odds-and-relative-odds-ratios"><span class="header-section-number">5.0.3</span> Conditional Odds and Relative Odds Ratios</h3>
<p>In <em>odds</em> and <em>odds ratios</em>, we can also condition on a subpopulation defined by an event.</p>
<ul>
<li><p>The <strong><em>odds</em> of <span class="math inline">\(B\)</span> among the subjects in <span class="math inline">\(A\)</span></strong> (or the <em>odds</em> of <span class="math inline">\(B\)</span> <strong>conditional</strong> on <span class="math inline">\(A\)</span>) are <span class="math display">\[
\text{Odds}(B|A)=\frac{P(B|A)}{P(B^c|A)}
\]</span> It measures how many times <span class="math inline">\(B\)</span> is more (or less) likely than “not <span class="math inline">\(B\)</span>” among the subjects in <span class="math inline">\(A\)</span>.</p></li>
<li><p>The <strong><em>odds ratio</em> of <span class="math inline">\(B\)</span> relative to <span class="math inline">\(A\)</span></strong> is <span class="math display">\[
\text{OR}(B|A)=\frac{\text{Odds}(B|A)}{\text{Odds}(B|A^c)}
\]</span> It measures how many times the <em>odds</em> of <span class="math inline">\(B\)</span> among the subjects in <span class="math inline">\(A\)</span> are greater (or smaller) than the <em>odds</em> of <span class="math inline">\(B\)</span> among the subjects outside <span class="math inline">\(A\)</span>.</p></li>
</ul>
<strong>Example:</strong>
<div style="border-left: 4px solid #f0ad4e; background-color: #fcf8e3; padding: 10px; margin: 10px 0;">
<p>Let’s go back to the situation in the cardiologist friend’s example. If, among our cardiologist friend’s patients, we call <span class="math inline">\(E\)</span> the event “Experience stress” and <span class="math inline">\(D\)</span> the event “Experience depression,” we would have calculated that <span class="math inline">\(P(E|D)=0.475\)</span> and <span class="math inline">\(P(E^c|D^c)=0.45\)</span>. If you did the exercise we suggested after the example, you would have calculated <span class="math inline">\(P(D|E)=0.6334\)</span> and <span class="math inline">\(P(D^c|E^c)=0.3\)</span>.</p>
<p>So:</p>
<ul>
<li>The <em>odds</em> of having stress among patients with depression are <span class="math display">\[
\text{Odds}(E|D)=\frac{P(E|D)}{P(E^c|D)}=\frac{0.475}{0.525}=0.905
\]</span></li>
</ul>
<p>Among patients with depression, the probability of having stress is 0.905 times that of not having it, that is, 9.5% lower.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Please don’t say that “the probability of having stress is 0.905 times <strong>greater</strong> than that of not having it.”</p>
</div>
</div>
<ul>
<li>The odds of having stress among patients who do not have depression are <span class="math display">\[
\text{Odds}(E|D^c)=\frac{P(E|D^c)}{P(E^c|D^c)}=\frac{0.55}{0.45}=1.22
\]</span></li>
</ul>
<p>Among patients without depression, the probability of having stress is 1.22 times that of not having it, that is, 22% higher.</p>
<ul>
<li>The odds of having depression among patients who have stress are <span class="math display">\[
\text{Odds}(D|E)=\frac{P(D|E)}{P(D^c|E)}=\frac{0.6334}{0.3666}=1.73
\]</span></li>
</ul>
<p>Among patients with stress, the probability of having Depression is 1.73 times that of not having it, or 73% higher.</p>
<ul>
<li>The <em>odds</em> of having depression among patients without stress are <span class="math display">\[
\text{Odds}(D|E^c)=\frac{P(D|E^c)}{P(D^c|E^c)}=\frac{0.7}{0.3}=2.33
\]</span></li>
</ul>
<p>Among patients without stress, the probability of having depression is 2.33 times that of not having it, or 133% higher.</p>
<ul>
<li>The <em>odds ratio</em> of having stress relative to having depression is <span class="math display">\[
\text{OR}(E|D)=\frac{\text{Odds}(E|D)}{\text{Odds}(E|D^c)}=\frac{0.905}{1.222}=0.74
\]</span></li>
</ul>
<p>The <em>odds</em> of having stress among those with depression are 0.74 times those of having stress among those without depression, or 26% lower.</p>
<ul>
<li>The odds ratio of having depression relative to having stress is <span class="math display">\[
\text{OR}(D|E)=\frac{\text{Odds}(D|E)}{\text{Odds}(D|E^c)}=\frac{1.73}{2.33}=0.74
\]</span></li>
</ul>
<p>The odds of having depression among those with stress are 0.74 times those of having depression among those without stress, again 26% lower.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>The odds of having stress among those with depression are 0.74 times those of having stress among those without depression, and the odds of having depression among those with stress are 0.74 times those of having depression among those without stress. <strong>But it is not true</strong> that the probability of having stress among those with depression is 0.74 times that of having stress among those without depression, nor that the probability of having depression among those with stress is 0.74 times that of having depression among those without stress. These ratios are <span class="math display">\[
\frac{P(E|D)}{P(E|D^c)}=\frac{0.475}{0.55}=0.864,\quad \frac{P(D|E)}{P(D|E^c)}=\frac{0.6334}{0.7}=0.905
\]</span></p>
</div>
</div>
<p>The <em>odds ratio</em> of having stress relative to having depression was the same as the <em>odds ratio</em> of having depression relative to having stress. Coincidence? No.</p>
</div>
<p><strong>Exercise:</strong> An early detection test for a disease is positive 97.5% of the time when the disease is present, and 12% of the time when the disease is not present. The probability that a randomly selected individual has this disease is 2%.</p>
<ol type="a">
<li><p>What is the probability that a randomly selected individual will test positive?</p></li>
<li><p>What is the probability that a randomly selected individual will have the disease and test positive?</p></li>
<li><p>What is the probability that an individual who tests positive will have this disease?</p></li>
<li><p>Are testing positive and having the disease independent events?</p></li>
</ol>
</section>
<section id="example-in-r" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="example-in-r"><span class="header-section-number">5.1</span> Example in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(epitools)) <span class="fu">install.packages</span>(<span class="st">"epitools"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: epitools</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epitools)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table: Stress vs Depression</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>stress_depression <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">95</span>, <span class="dv">55</span>, <span class="dv">105</span>, <span class="dv">45</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(stress_depression) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Stress"</span>, <span class="st">"NoStress"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(stress_depression) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Depression"</span>, <span class="st">"NoDepression"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>stress_depression</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Depression NoDepression
Stress           95           55
NoStress        105           45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Odds ratio using epitools</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">oddsratio</span>(stress_depression)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$data
         Depression NoDepression Total
Stress           95           55   150
NoStress        105           45   150
Total           200          100   300

$measure
                        NA
odds ratio with 95% C.I.  estimate     lower    upper
                Stress   1.0000000        NA       NA
                NoStress 0.7413724 0.4560015 1.200648

$p.value
          NA
two-sided  midp.exact fisher.exact chi.square
  Stress           NA           NA         NA
  NoStress  0.2240362    0.2703061  0.2206714

$correction
[1] FALSE

attr(,"method")
[1] "median-unbiased estimate &amp; mid-p exact CI"</code></pre>
</div>
</div>
</section>
<section id="chi-squared-test" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Chi-Squared Test</h1>
<p>The chi-squared test is used to test <strong>independence between categorical variables</strong>.</p>
<section id="example-in-r-1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="example-in-r-1"><span class="header-section-number">6.1</span> Example in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table: Glasses vs Gender</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>glasses_gender <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">18</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">5</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(glasses_gender) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Women"</span>, <span class="st">"Men"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(glasses_gender) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Glasses"</span>, <span class="st">"NoGlasses"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>glasses_gender</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Glasses NoGlasses
Women      18        12
Men        15         5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-squared test</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(glasses_gender, <span class="at">correct=</span><span class="cn">FALSE</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>chi_test</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  glasses_gender
X-squared = 1.2032, df = 1, p-value = 0.2727</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected counts under independence</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>chi_test<span class="sc">$</span>expected</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Glasses NoGlasses
Women    19.8      10.2
Men      13.2       6.8</code></pre>
</div>
</div>
</section>
</section>
<section id="relative-risk" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Relative Risk</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">riskratio</span>(stress_depression)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$data
         Depression NoDepression Total
Stress           95           55   150
NoStress        105           45   150
Total           200          100   300

$measure
                        NA
risk ratio with 95% C.I.  estimate     lower    upper
                Stress   1.0000000        NA       NA
                NoStress 0.8181818 0.5926525 1.129535

$p.value
          NA
two-sided  midp.exact fisher.exact chi.square
  Stress           NA           NA         NA
  NoStress  0.2240362    0.2703061  0.2206714

$correction
[1] FALSE

attr(,"method")
[1] "Unconditional MLE &amp; normal approximation (Wald) CI"</code></pre>
</div>
</div>
</section>
<section id="exercises" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Exercises</h1>
<ol type="1">
<li>Create a 2x2 table for a disease test (positive/negative) vs actual disease (yes/no). Compute:
<ul>
<li>Odds of testing positive given disease</li>
<li>Odds ratio</li>
<li>Chi-squared test for independence</li>
</ul></li>
<li>Interpret your results in terms of risk and association.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/Cruzalirio\.github\.io\/Nutrigenomics");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./04_ProbOddsChiCuadrado.html" class="pagination-link" aria-label="Probability">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probability</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06_Descriptiva.html" class="pagination-link" aria-label="Descriptive Statistics">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Descriptive Statistics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Design of Experimental Studies and Statistics Applied to Nutrigenomics</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Cruzalirio/Nutrigenomics/edit/main/05_Odds.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/Cruzalirio/Nutrigenomics/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book has been created with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>